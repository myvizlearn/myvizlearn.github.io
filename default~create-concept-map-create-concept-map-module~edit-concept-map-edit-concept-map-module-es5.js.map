{"version":3,"sources":["./src/app/create-concept-map/conceptmap/conceptmap.component.html","./src/app/create-concept-map/conceptmap/handle.component.html","./src/app/create-concept-map/conceptmap/proposition.component.html","./node_modules/rxjs-compat/_esm5/add/operator/first.js","./node_modules/rxjs-compat/_esm5/operator/first.js","./src/app/create-concept-map/conceptmap/componentmanager.service.ts","./src/app/create-concept-map/conceptmap/concept.component.ts","./src/app/create-concept-map/conceptmap/conceptmap.component.css","./src/app/create-concept-map/conceptmap/conceptmap.component.ts","./src/app/create-concept-map/conceptmap/conceptmap.module.ts","./src/app/create-concept-map/conceptmap/conceptmap.types.ts","./src/app/create-concept-map/conceptmap/contenteditable.directive.ts","./src/app/create-concept-map/conceptmap/handle.component.ts","./src/app/create-concept-map/conceptmap/mouse.service.ts","./src/app/create-concept-map/conceptmap/proposition.component.ts","./src/app/create-concept-map/conceptmap/selection.service.ts","./src/app/create-concept-map/conceptmap/utils.ts"],"names":[],"mappings":"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","file":"default~create-concept-map-create-concept-map-module~edit-concept-map-edit-concept-map-module-es5.js","sourcesContent":["module.exports = \"<style>\\n/* Concept map element specific styles*/\\n:host {\\n  display: block;\\n  position: absolute;\\n  overflow: hidden;\\n}\\n</style>\\n\\n<!-- define SVG arrow marker used by propositions -->\\n<svg>\\n  <defs>\\n    <marker id=\\\"cm-arrow\\\"  refX=\\\"10\\\" refY=\\\"5\\\" markerWidth=\\\"12\\\" markerHeight=\\\"8\\\" orient=\\\"auto\\\" >\\n      <path stroke=\\\"#f00\\\" stroke-width=\\\"3\\\" d=\\\"M 0,20 L 10,5 L 0,10 L 4,5 z\\\"/>\\n    </marker>\\n  </defs>\\n</svg>\\n\\n<cm-concept *ngFor=\\\"let c of cmap.concepts\\\" [concept]=\\\"c\\\" [style.top.px]=\\\"c.y\\\" [style.left.px]=\\\"c.x\\\" [(cmContenteditableModel)]=\\\"c.text\\\">{{c.x}}-{{c.y}}</cm-concept>\\n<cm-proposition *ngFor=\\\"let p of cmap.propositions\\\" [proposition]=\\\"p\\\"></cm-proposition>\\n\\n<div *ngIf=\\\"rubberband\\\" id=\\\"rubber-band\\\" [style.top.px] = \\\"rubberband.top\\\" [style.left.px] = \\\"rubberband.left\\\" [style.width.px] = \\\"rubberband.width\\\" [style.height.px] = \\\"rubberband.height\\\"></div>\\n\\n<cm-handle *ngIf=\\\"getSingleSelection\\\" [from]=\\\"getSingleSelection\\\"></cm-handle>\\n\\n\"","module.exports = \"<svg>\\n  <svg:path *ngIf=\\\"!dragged\\\" [attr.d]=\\\"linePath()\\\"></svg:path>\\n  <svg:path *ngIf=\\\"dragged\\\" [attr.d]=\\\"linePath()\\\" marker-end=\\\"url(#cm-arrow)\\\"></svg:path>\\n</svg>\\n\\n<div *ngIf=\\\"!dragged\\\" id=\\\"cm-handle-label\\\" class=\\\"prevent-select\\\" [style.left.px]=\\\"x\\\" [style.top.px]=\\\"y\\\" (mousedown)=\\\"mouseDown($event);\\\">\\n  Drag to Connect\\n</div>\\n<div *ngIf=\\\"!dragged\\\" id=\\\"cm-handle-label\\\" class=\\\"prevent-select\\\" [style.left.px]=\\\"x\\\" [style.top.px]=\\\"y\\\" (mousedown)=\\\"mouseDown($event);\\\">\\n  Drag to Connect\\n</div>\\n\"","module.exports = \"<svg>\\n  <svg:path [attr.d]=\\\"svgLinePath\\\" marker-end=\\\"url(#cm-arrow)\\\"></svg:path>\\n</svg>\\n\\n<div #label class=\\\"cm-label\\\" [style.top.px]=\\\"labelY\\\" [style.left.px]=\\\"labelX\\\" (mousedown)=\\\"mouseDown($event);\\\" (mouseup)=\\\"mouseUp($event);\\\" (dblclick)=\\\"doubleClick($event);\\\" (keydown)=\\\"keyDown($event)\\\" [class.selected]=\\\"selected\\\" [class.prevent-select]=\\\"preventSelect\\\" [attr.contenteditable]=\\\"editable\\\" [(cmContenteditableModel)]=\\\"proposition.text\\\"></div>\\n\"","import { Observable } from 'rxjs';\nimport { first } from '../../operator/first';\nObservable.prototype.first = first;\n//# sourceMappingURL=first.js.map","import { first as higherOrder } from 'rxjs/operators';\nexport function first() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return higherOrder.apply(void 0, args)(this);\n}\n//# sourceMappingURL=first.js.map","import { Injectable } from '@angular/core';\n\nimport { ConceptComponent } from './concept.component';\nimport { PropositionComponent } from './proposition.component';\nimport { Concept } from './conceptmap.types';\n\n/**\n * Component Manager service collects all component so communication could be easier.\n * All concept and proposition component should register them self into the manager upon initiation.\n */\n@Injectable()\nexport class ComponentManager {\n  conceptComponents = new Set<ConceptComponent>();\n  propositionComponents = new Set<PropositionComponent>();\n\n  addConceptComponent(component: ConceptComponent) {\n    this.conceptComponents.add(component);\n  }\n\n  getConceptComponent(concept: Concept) {\n    return Array.from(this.conceptComponents).find(c => c.concept === concept);\n  }\n\n  removeConceptComponent(component: ConceptComponent) {\n    this.conceptComponents.delete(component);\n  }\n\n  addPropositionComponent(component: PropositionComponent) {\n    this.propositionComponents.add(component);\n  }\n\n  removePropositionComponent(component: PropositionComponent) {\n    this.propositionComponents.delete(component);\n  }\n}\n","import { Component, Input, HostListener, HostBinding, ElementRef, OnInit, OnDestroy } from '@angular/core';\n\nimport { Concept } from './conceptmap.types';\nimport { MouseService  } from './mouse.service';\nimport { SelectionService, Selectable } from './selection.service';\nimport { ComponentManager } from './componentmanager.service';\nimport { KeyCombination } from './utils';\n\n/**\n * Concept component. Define the concept html element.\n */\n@Component({\n  selector: 'cm-concept',\n  template: '',\n})\nexport class ConceptComponent implements OnInit, OnDestroy, Selectable {\n\n  @Input() concept: Concept;\n\n  @HostBinding('class.selected') selected = false;\n\n  @HostBinding('class.prevent-select') preventSelect = true;\n\n  @HostBinding('attr.contenteditable') editable = false;\n\n  ctrlA = new KeyCombination('A', [KeyCombination.modifierKey.ctrl]);\n\n  constructor(\n    protected selection: SelectionService,\n    protected mouse: MouseService,\n    protected manager: ComponentManager,\n    protected element: ElementRef\n  ) { }\n\n  get height() {\n    return this.element.nativeElement.offsetHeight;\n  }\n\n  get width() {\n    return this.element.nativeElement.offsetWidth;\n  }\n\n  ngOnInit() {\n    this.manager.addConceptComponent(this);\n    // get focus on creation\n    if (!this.concept.text) {\n      window.setTimeout(() => {\n        this.selection.clear();\n        this.selection.addConceptComponent(this);\n        this.enableEdit();\n      }, 0);\n    }\n  }\n\n  ngOnDestroy() {\n    this.manager.removeConceptComponent(this);\n  }\n\n  select() {\n    this.selected = true;\n  }\n\n  deselect(): void {\n    this.selected = false;\n    if (this.editable) {\n      this.disableEdit();\n    }\n  }\n\n  enableEdit() {\n    this.editable = true;\n    this.preventSelect = false;\n\n    window.setTimeout(() => {\n      this.element.nativeElement.focus();\n      const range = document.createRange();\n      range.selectNodeContents(this.element.nativeElement);\n      const sel = window.getSelection();\n      sel.removeAllRanges();\n      sel.addRange(range);\n    }, 0);\n  }\n\n  disableEdit() {\n    this.editable = false;\n    this.preventSelect = true;\n  }\n\n  @HostListener('mousedown', ['$event']) mouseDown(event) {\n    this.mouse.down(this, event);\n    if (event.which === 1) {\n      if (!this.editable /* disable drag while been editable */) {\n\n        if (event.ctrlKey || event.shiftKey) {\n          if (this.selected) {\n            let dragged = false;\n            this.mouse.drag(\n              e => dragged = true,\n              e => {\n                if (e.browserEvent.which === 1 && !dragged) {\n                  this.selection.removeConceptComponent(this);\n                }\n              }\n            );\n          } else {\n            this.selection.addConceptComponent(this);\n          }\n        } else {\n          if (this.selected) {\n            let dragged = false;\n            this.mouse.drag(\n              e => dragged = true,\n              e => {\n                if (e.browserEvent.which === 1 && !dragged) {\n                  this.selection.clear();\n                  this.selection.addConceptComponent(this);\n                }\n              }\n            );\n          } else {\n            this.selection.clear();\n            this.selection.addConceptComponent(this);\n          }\n        }\n\n        this.mouse.drag(\n          e => {\n            this.mouse.cursorStyle = 'move';\n            this.selection.selectedConceptComponent.forEach((c) => {\n              c.concept.x += e.browserEvent.movementX;\n              c.concept.y += e.browserEvent.movementY;\n            });\n          },\n          e => {\n            if (e.browserEvent.which === 1)  {\n              this.mouse.cursorStyle = 'default';\n            }\n          }\n        );\n\n      }\n    }\n    event.stopPropagation();\n  }\n\n  @HostListener('mouseup', ['$event']) mouseUp(event) {\n    this.mouse.up(this, event);\n    event.stopPropagation();\n  }\n\n  @HostListener('dblclick', ['$event']) doubleClick(event) {\n    event.stopPropagation();\n    // when not selecting\n    if (!event.ctrlKey && !event.shiftKey) {\n      if (!this.editable) {\n        this.enableEdit();\n      }\n    }\n  }\n\n  @HostListener('keydown', ['$event']) keyDown(event) {\n    if (this.ctrlA.match(event) || (event.key === 'Delete' || event.key === 'Del' || event.which === 46)) {\n      event.stopPropagation();\n    }\n    setTimeout(() => {}, 0);  // used to manually trigger angular life cycle check to detect element size change.\n  }\n\n}\n","module.exports = \"\\ncm-concept {\\n  position: absolute;\\n  -webkit-transform: translate(-50%, -50%);\\n          transform: translate(-50%, -50%);\\n  min-height: 1em;\\n  z-index: 1;\\n\\n  background-color: lightgrey;\\n  padding: 6px 18px;\\n  border: 1px solid black;\\n}\\n\\nsvg {\\n  position: absolute;\\n  overflow: visible;\\n  top: 0;\\n  left: 0;\\n  /* z-index: -1; */\\n}\\n\\npath {\\n  stroke: #000000;\\n  stroke-width: 1;\\n}\\n\\n#cm-handle-label {\\n  padding: 2px 4px;\\n  position: absolute;\\n  -webkit-transform: translate(-50%, -50%);\\n          transform: translate(-50%, -50%);\\n  background-color: white;\\n  border: 1px solid black;\\n}\\n\\n.prevent-select {\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n      -ms-user-select: none;\\n          user-select: none;\\n}\\n\\n.selected {\\n  box-shadow: 0 0 1px 2px cornflowerblue;\\n}\\n\\n.cm-label {\\n  position: absolute;\\n  -webkit-transform: translate(-50%, -50%);\\n          transform: translate(-50%, -50%);\\n  min-height: 1em;\\n\\n  background-color:#fff;\\n  padding: 4px 10px;\\n  border-radius: 10px;\\n}\\n\\n#rubber-band {\\n  background-color: #99ccff;\\n  border: 1px solid #0000dd;\\n  position: absolute;\\n  opacity: 0.3;\\n  z-index: 2;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY3JlYXRlLWNvbmNlcHQtbWFwL2NvbmNlcHRtYXAvY29uY2VwdG1hcC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQTtFQUNFLGtCQUFrQjtFQUNsQix3Q0FBZ0M7VUFBaEMsZ0NBQWdDO0VBQ2hDLGVBQWU7RUFDZixVQUFVOztFQUVWLDJCQUEyQjtFQUMzQixpQkFBaUI7RUFDakIsdUJBQXVCO0FBQ3pCOztBQUVBO0VBQ0Usa0JBQWtCO0VBQ2xCLGlCQUFpQjtFQUNqQixNQUFNO0VBQ04sT0FBTztFQUNQLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLGVBQWU7RUFDZixlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtFQUNsQix3Q0FBZ0M7VUFBaEMsZ0NBQWdDO0VBQ2hDLHVCQUF1QjtFQUN2Qix1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSx5QkFBaUI7S0FBakIsc0JBQWlCO01BQWpCLHFCQUFpQjtVQUFqQixpQkFBaUI7QUFDbkI7O0FBRUE7RUFDRSxzQ0FBc0M7QUFDeEM7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsd0NBQWdDO1VBQWhDLGdDQUFnQztFQUNoQyxlQUFlOztFQUVmLHFCQUFxQjtFQUNyQixpQkFBaUI7RUFDakIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLHlCQUF5QjtFQUN6QixrQkFBa0I7RUFDbEIsWUFBWTtFQUNaLFVBQVU7QUFDWiIsImZpbGUiOiJzcmMvYXBwL2NyZWF0ZS1jb25jZXB0LW1hcC9jb25jZXB0bWFwL2NvbmNlcHRtYXAuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIlxuY20tY29uY2VwdCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gIG1pbi1oZWlnaHQ6IDFlbTtcbiAgei1pbmRleDogMTtcblxuICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyZXk7XG4gIHBhZGRpbmc6IDZweCAxOHB4O1xuICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcbn1cblxuc3ZnIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICAvKiB6LWluZGV4OiAtMTsgKi9cbn1cblxucGF0aCB7XG4gIHN0cm9rZTogIzAwMDAwMDtcbiAgc3Ryb2tlLXdpZHRoOiAxO1xufVxuXG4jY20taGFuZGxlLWxhYmVsIHtcbiAgcGFkZGluZzogMnB4IDRweDtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTtcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xufVxuXG4ucHJldmVudC1zZWxlY3Qge1xuICB1c2VyLXNlbGVjdDogbm9uZTtcbn1cblxuLnNlbGVjdGVkIHtcbiAgYm94LXNoYWRvdzogMCAwIDFweCAycHggY29ybmZsb3dlcmJsdWU7XG59XG5cbi5jbS1sYWJlbCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gIG1pbi1oZWlnaHQ6IDFlbTtcblxuICBiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7XG4gIHBhZGRpbmc6IDRweCAxMHB4O1xuICBib3JkZXItcmFkaXVzOiAxMHB4O1xufVxuXG4jcnViYmVyLWJhbmQge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjOTljY2ZmO1xuICBib3JkZXI6IDFweCBzb2xpZCAjMDAwMGRkO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIG9wYWNpdHk6IDAuMztcbiAgei1pbmRleDogMjtcbn1cbiJdfQ== */\"","import { Component, HostListener, HostBinding, DoCheck } from '@angular/core';\n\nimport { ConceptMap } from './conceptmap.types';\nimport { MouseService } from './mouse.service';\nimport { SelectionService } from './selection.service';\nimport { ComponentManager } from './componentmanager.service';\n\n/**\n * Representing the selection rubber band\n */\nclass RubberBand {\n    x: number;\n    y: number;\n    top: number;\n    left: number;\n    width: number;\n    height: number;\n\n    constructor(x: number, y: number) {\n      this.x = x;\n      this.y = y;\n    }\n\n    include(x: number, y: number) {\n      return this.top < y && y < this.top + this.height && this.left < x && x < this.left + this.width;\n    }\n  }\n\n/**\n * Concept Map component. Define the concept map element.\n * This element contains a number of concept and propositon elements to create a concept map.\n */\n@Component({\n  selector: 'cm-concept-map',\n  templateUrl: './conceptmap.component.html',\n  styleUrls: ['./conceptmap.component.css']\n})\nexport class ConceptMapComponent implements DoCheck {\n\n  @HostBinding('style.cursor') protected cursorStyle = 'default';\n\n  rubberband: RubberBand;\n\n  constructor(\n    protected mouse: MouseService,\n    public selection: SelectionService,\n    public manager: ComponentManager,\n    public cmap: ConceptMap,\n  ) { }\n\n  ngDoCheck() {\n    this.cursorStyle = this.mouse.cursorStyle;\n  }\n\n  /**\n   * This method will return a single concept component if it's the only selected one, otherwise undefined\n   */\n  get getSingleSelection() {\n    if (this.selection.selectedConceptComponent.size === 1 && this.selection.selectedPropositionComponent.size === 0) {\n      return this.selection.selectedConceptComponent.values().next().value;\n    }\n    return undefined;\n  }\n\n  import(data: string) {\n    this.selection.clear();\n    this.cmap.parseJson(data);\n  }\n\n  export(): string {\n    return this.cmap.toJson();\n  }\n\n  deleteSelected() {\n    Array.from(this.manager.propositionComponents).filter(p => p.selected).forEach(p => this.cmap.removeProposition(p.proposition));\n    Array.from(this.manager.conceptComponents).filter(c => c.selected).forEach(c => this.cmap.removeConcept(c.concept));\n    this.selection.clear();\n  }\n\n  selectAll() {\n    this.selection.clear();\n    this.manager.conceptComponents.forEach(concept => this.selection.addConceptComponent(concept));\n  }\n\n  @HostListener('dblclick', ['$event']) protected doubleClick(event) {\n\n    console.log(event);\n    this.cmap.addConcept('', event.layerX, event.layerY, ['none']);\n    // this.cmap.addConcept('', event.clientX, event.clientY);\n  }\n\n  @HostListener('mousedown', ['$event']) protected mouseDown(event) {\n    this.mouse.down(this, event);\n    if (event.which === 1) {\n      if (event.altKey) {\n        this.mouse.drag(\n          e => {\n            this.mouse.cursorStyle = 'move';\n            this.cmap.concepts.forEach(c => {\n              c.x += e.browserEvent.movementX;\n              c.y += e.browserEvent.movementY;\n            });\n          },\n          e => {\n            if (e.browserEvent.which === 1)  {\n              this.mouse.cursorStyle = 'default';\n            }\n          }\n        );\n      } else {\n        if (!event.ctrlKey) {\n          this.selection.clear();\n        }\n        this.mouse.drag(\n          e => {\n            // create rubber band if drag starts.\n            if (!this.rubberband) {\n              this.rubberband = new RubberBand(this.mouse.position.x, this.mouse.position.y);\n            }\n            this.rubberband.top = Math.min(this.rubberband.y, this.mouse.position.y);\n            this.rubberband.left = Math.min(this.rubberband.x, this.mouse.position.x);\n            this.rubberband.width = Math.max(this.rubberband.x, this.mouse.position.x) - this.rubberband.left;\n            this.rubberband.height = Math.max(this.rubberband.y, this.mouse.position.y) - this.rubberband.top;\n            // select components\n            // todo: better control-select operation\n            this.manager.conceptComponents.forEach(c => {\n              if (this.rubberband.include(c.concept.x, c.concept.y)) {\n                this.selection.addConceptComponent(c);\n              } else {\n                this.selection.removeConceptComponent(c);\n              }\n            });\n            this.manager.propositionComponents.forEach(p => {\n              if (this.rubberband.include(p.labelX, p.labelY)) {\n                this.selection.addPropositionComponent(p);\n              } else {\n                this.selection.removePropositionComponent(p);\n              }\n            });\n          },\n          e => {\n            if (e.browserEvent.which === 1)  {\n              this.rubberband = undefined;\n            }\n          }\n        );\n      }\n\n    }\n  }\n\n  @HostListener('mouseup', ['$event']) protected mouseUp(event) {\n    this.mouse.up(this, event);\n  }\n\n  @HostListener('mousemove', ['$event']) protected mouseMove(event) {\n    this.mouse.move(this, event);\n  }\n\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\n\nimport { ConceptMapComponent } from './conceptmap.component';\nimport { ConceptComponent } from './concept.component';\nimport { PropositionComponent } from './proposition.component';\nimport { HandleComponent } from './handle.component';\nimport { MouseService  } from './mouse.service';\nimport { SelectionService  } from './selection.service';\nimport { ConceptMap } from './conceptmap.types';\nimport { ComponentManager } from './componentmanager.service';\nimport { ContenteditableDirective } from './contenteditable.directive';\n\n/**\n * ConceptMap module\n */\n@NgModule({\n  declarations: [\n    ConceptMapComponent,\n    ConceptComponent,\n    PropositionComponent,\n    HandleComponent,\n    ContenteditableDirective\n  ],\n  imports: [\n    // BrowserModule\n    CommonModule\n  ],\n  exports: [\n    ConceptMapComponent\n  ],\n  providers: [\n    MouseService,\n    SelectionService,\n    ConceptMap,\n    ComponentManager\n  ]\n})\nexport class ConceptMapModule {\n\n}\n","import { Injectable } from '@angular/core';\n\n/**\n * Represent concepts in concept maps.\n */\nexport class Concept {\n  text: string;\n  x: number;\n  y: number;\n  resources: [];\n\n  constructor(text: string, x: number, y: number, resources: any) {\n    this.text = text;\n    this.x = x;\n    this.y = y;\n    this.resources = [];\n  }\n}\n\n/**\n * Represent propositions in concept maps. It points from one concept to another\n */\nexport class Proposition {\n  text: string;\n  from: Concept;\n  to: Concept;\n\n  constructor(text: string, from: Concept, to: Concept) {\n    this.text = text;\n    this.from = from;\n    this.to = to;\n  }\n}\n\nfunction randomHex(range = 0xffffffff) {\n  return Math.floor(Math.random() * range).toString(16);\n}\n\n/**\n * A collection of concepts and propositions.\n */\n@Injectable()\nexport class ConceptMap {\n\n  concepts: Set<Concept> = new Set<Concept>();\n  propositions: Set<Proposition> = new Set<Proposition>();\n\n  getID = randomHex;\n\n  addConcept(text: string, x: number, y: number, resources: any) {\n    this.concepts.add(new Concept(text, x, y, resources));\n  }\n\n  addProposition(text: string, from: Concept, to: Concept) {\n    this.propositions.add(new Proposition(text, from, to));\n  }\n\n  removeProposition(prop: Proposition) {\n    this.propositions.delete(prop);\n  }\n\n  /**\n   * Remove a concept and all propositions that links to and from it.\n   */\n  removeConcept(concept: Concept) {\n    for (const prop of Array.from(this.propositions).filter(p => p.from === concept || p.to === concept)) {\n      this.removeProposition(prop);\n    }\n    this.concepts.delete(concept);\n  }\n\n  /**\n   * Export a concept map to JSON format\n   * will assign every concept with an id.\n   */\n  toJson() {\n    const map = {\n      concepts: [],\n      propositions: []\n    };\n\n    // Efforts to avoid id collisions - not sure whether necessary :/\n    const ids = new Set<string>();\n    const conceptIDs = new Map<Concept, string>();\n    this.concepts.forEach(c => {\n      let id = this.getID();\n      while (ids.has(id)) {\n        id = this.getID();\n      }\n      ids.add(id);\n      conceptIDs.set(c, id);\n      map.concepts.push({text: c.text, x: c.x, y: c.y, id: id, resources: c.resources });\n    });\n\n    this.propositions.forEach(p => {\n      map.propositions.push({\n        text: p.text,\n        from: conceptIDs.get(p.from),\n        to: conceptIDs.get(p.to)\n      });\n    });\n\n    return JSON.stringify(map);\n  }\n\n  /**\n   * Parse a JSON string into a concept map\n   * will overwrite current map if loaded successfully\n   */\n  parseJson(data: string) {\n    const map = JSON.parse(data);\n\n    const concepts = new Set<Concept>();\n    const propositions = new Set<Proposition>();\n\n    const lookup = {};\n    for (const c of map.concepts) {\n      const concept = new Concept(c.text, c.x, c.y, c.resources);\n      lookup[c.id] = concept;\n      concepts.add(concept);\n    }\n\n    for (const p of map.propositions) {\n      propositions.add(new Proposition(p.text, lookup[p.from], lookup[p.to]));\n    }\n\n    this.concepts = concepts;\n    this.propositions = propositions;\n  }\n}\n","import { Directive, OnChanges, HostListener, ElementRef, Input, Output, EventEmitter, SimpleChanges } from '@angular/core';\n\n@Directive({\n  selector: '[cmContenteditableModel]'\n})\nexport class ContenteditableDirective implements OnChanges {\n\n  @Input() cmContenteditableModel: string;\n  @Output() cmContenteditableModelChange = new EventEmitter();\n\n  constructor(private element: ElementRef) { }\n\n  ngOnChanges(changes: SimpleChanges) {\n    this.refreshView();\n  }\n\n  @HostListener('blur') updateModel() {\n    setTimeout(() => this.cmContenteditableModelChange.emit(this.element.nativeElement.innerHTML), 0);\n  }\n\n  refreshView() {\n    this.element.nativeElement.innerHTML = this.cmContenteditableModel;\n  }\n}\n","import { Component, Input, OnChanges, DoCheck } from '@angular/core';\n\nimport { Concept, ConceptMap, Proposition } from './conceptmap.types';\nimport { MouseService  } from './mouse.service';\nimport { ConceptComponent } from './concept.component';\n\n/**\n * Handle component. used to create propositions.\n * This component is draggable so the user can create propositions by dragging from a concept to another.\n */\n@Component({\n  selector: 'cm-handle',\n  templateUrl: './handle.component.html',\n  styleUrls: ['./conceptmap.component.css']\n})\nexport class HandleComponent implements DoCheck, OnChanges {\n\n  @Input() from: ConceptComponent;\n\n  x: number;\n  y: number;\n\n  conceptPosition = {x: -1, y: -1, height: -1};\n  dragged: boolean;\n\n  constructor(\n    private mouse: MouseService,\n    private cmap: ConceptMap\n  ) { }\n\n  ngOnChanges() {\n    this.x = this.from.concept.x;\n    this.y = this.from.concept.y - this.from.height / 2 - 20;\n  }\n\n  ngDoCheck() {\n    // check if the belonging concept moved and update position if needed\n    if (\n      this.from.concept.x !== this.conceptPosition.x\n      ||\n      this.from.concept.y !== this.conceptPosition.y\n      ||\n      this.from.height !== this.conceptPosition.height\n    ) {\n      this.conceptPosition.x = this.from.concept.x;\n      this.conceptPosition.y = this.from.concept.y;\n      this.conceptPosition.height = this.from.height;\n      this.ngOnChanges();\n    }\n  }\n\n  createProposition(from: Concept, to: Concept) {\n    if (!Array.from(this.cmap.propositions).some(p => p.from === from && p.to === to || p.from === to && p.to === from)) {\n      this.cmap.propositions.add(new Proposition('', from, to));\n    }\n  }\n\n  linePath() {\n    return [\n      'M', this.from.concept.x, this.from.concept.y,\n      'L', this.x, this.y\n    ].join(' ');\n  }\n\n  mouseDown(event) {\n    this.mouse.down(this, event);\n    if (event.which === 1) {\n      this.mouse.drag(\n        e => {\n          this.dragged = true;\n          this.x = this.mouse.position.x;\n          this.y = this.mouse.position.y;\n        },\n        e => {\n          if (e.browserEvent.which === 1) {\n            if (e.component.concept) {\n              this.createProposition(this.from.concept, e.component.concept);\n            }\n            this.dragged = false;\n            this.x = this.from.concept.x;\n            this.y = this.from.concept.y - this.from.height / 2 - 16;\n          }\n        }\n      );\n    }\n    event.stopPropagation();\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { Subject } from 'rxjs';\nimport 'rxjs/add/operator/first';\nimport {first} from 'rxjs/operators';\n\n/**\n * An event wrapper that also records the component emitted this event.\n */\nclass MouseEvent {\n\n  component: any;\n  browserEvent: any;\n\n  constructor(component, event) {\n    this.component = component;\n    this.browserEvent = event;\n  }\n}\n\n/**\n * MouseService, deals with user interaction.\n * This service operates on rxjs Subject to make events observable\n * and also provides drag handling.\n */\n@Injectable()\nexport class MouseService {\n\n  cursorStyle = 'default';\n  position = {x: 0, y: 0};  // cursor position\n\n  mouseMoveEvents = new Subject<MouseEvent>();\n  mouseUpEvents = new Subject<MouseEvent>();\n  mouseDownEvents = new Subject<MouseEvent>();\n\n  /**\n   * Should be called when there is a mouse down event\n   */\n  down(sourceComponent: any, event: any) {\n    this.mouseDownEvents.next(new MouseEvent(sourceComponent, event));\n  }\n\n  /**\n   * Should be called when there is a mouse up event\n   */\n  up(sourceComponent: any, event: any) {\n    this.mouseUpEvents.next(new MouseEvent(sourceComponent, event));\n  }\n\n  /**\n   * Should be called when there is a mouse move event\n   * this function uses customised movement calculation and also filters zero distance movements.\n   */\n  move(sourceComponent: any, event: any) {\n\n    // Object.defineProperty(event, 'movementX', {value : event.clientX - this.position.x});\n    // Object.defineProperty(event, 'movementY', {value : event.clientY - this.position.y}); \n\n    Object.defineProperty(event, 'movementX', {value : event.layerX - this.position.x});\n    Object.defineProperty(event, 'movementY', {value : event.layerY - this.position.y});\n\n    // const bounds = event.target.getBoundingClientRect();\n    // const x = event.clientX - bounds.left;\n    // const y = event.clientY - bounds.top;\n    // console.log('x -',x,' y- ',y);\n    // console.log('layer x - ',event.layerX,\" layer y-\",event.layerY);\n    // console.log('client x - ',event.clientX,\" client y-\",event.clientY);\n\n    this.position.x = event.layerX;\n    this.position.y = event.layerY;\n\n    // this.position.x = event.clientX;\n    // this.position.y = event.clientY;\n    //  this condition filters some mousemove events that are actually not moved on Chrome\n    if (event.movementX !== 0 || event.movementY !== 0) {\n      this.mouseMoveEvents.next(new MouseEvent(sourceComponent, event));\n    }\n  }\n\n  /**\n   * Subscribe to drag operation\n   * Should be called after a mouse down event\n   * OnDrag callback will be executed on every mouse move, and OnDragEnd will be executed on mouse up.\n   */\n  drag(onDrag: (mouseEvent: MouseEvent) => void, onDragEnd: (mouseEvent: MouseEvent) => void) {\n    const mouseMoveSub = this.mouseMoveEvents.subscribe(onDrag);\n    this.mouseUpEvents.first().subscribe(\n      event => {\n        onDragEnd(event);\n        mouseMoveSub.unsubscribe();\n      }\n    );\n  }\n\n}\n","import { Component, Input, ViewChild, ElementRef, OnInit, OnDestroy, DoCheck } from '@angular/core';\n\nimport { ConceptComponent } from './concept.component';\nimport { Proposition } from './conceptmap.types';\nimport { MouseService } from './mouse.service';\nimport { SelectionService, Selectable } from './selection.service';\nimport { ComponentManager } from './componentmanager.service';\n\nimport { KeyCombination } from './utils';\n\n/**\n * Function used to calculate how proposition lines are to be clipped by concepts\n */\nfunction rectangleClip(rectWidth, rectHeight, x, y): {x: number, y: number} {\n\n  const heightBound = rectHeight / 2;\n  const widthBound = rectWidth / 2;\n  /*\n    * The two condition below indecates the direction of the 'from' concept at the 'to' concept\n    * which is needed to decide which edge of the 'to' concept should be used for clipping.\n    *\n    * t1, t2 will show values as illustrated below.\n    *             \\  false, true /\n    *              +------------+\n    * false, false | to concept | true, true\n    *              +------------+\n    *             /  true, false \\\n    */\n  const t1 = heightBound / widthBound * x + y > 0;  // true - on lower right region, false - on upper left region\n  const t2 = heightBound / widthBound * x - y > 0;  // true - on upper right region, false - on lower left region\n\n  const clipped = {x: 0, y: 0};\n\n  if (t1) {\n    if (t2) {\n      // true, ture - clip with the right edge\n      clipped.x = -widthBound;\n      clipped.y = -widthBound * y / x;\n    } else {\n      // true, false - clip with the bottom edge\n      clipped.y = -heightBound;\n      clipped.x = -heightBound * x / y;\n    }\n  } else {\n    if (t2) {\n      // false, ture - clip with the top edge\n      clipped.y = heightBound;\n      clipped.x = heightBound * x / y;\n    } else {\n      // false, false - clip with the left edge\n      clipped.x = widthBound;\n      clipped.y = widthBound * y / x;\n    }\n  }\n\n  return clipped;\n}\n\n/**\n * Proposition component. Define the Proposition html element.\n * This element further contains an SVG path and a label.\n */\n@Component({\n  selector: 'cm-proposition',\n  templateUrl: './proposition.component.html',\n  styleUrls: ['./conceptmap.component.css']\n})\nexport class PropositionComponent implements OnInit, OnDestroy, DoCheck, Selectable {\n\n  @Input() proposition: Proposition;\n\n  selected = false;\n\n  preventSelect = true;\n\n  editable = false;\n\n  ctrlA = new KeyCombination('A', [KeyCombination.modifierKey.ctrl]);\n\n  @ViewChild('label', {static: true}) label: ElementRef;\n\n  from: ConceptComponent;\n  to: ConceptComponent;\n\n  private shape = {\n    from: {height: 0, width: 0},\n    to: {height: 0, width: 0},\n    diff: {x: 0, y: 0},\n    startClipping: {x: 0, y: 0},\n    endClippint: {x: 0, y: 0},\n    label: {x: 0, y: 0}\n  };\n\n  constructor(\n    protected selection: SelectionService,\n    protected mouse: MouseService,\n    protected manager: ComponentManager\n  ) { }\n\n  get labelX() {\n    return (this.from.concept.x + this.shape.startClipping.x + this.to.concept.x + this.shape.endClippint.x) / 2;\n  }\n\n  get labelY() {\n    return (this.from.concept.y + this.shape.startClipping.y + this.to.concept.y + this.shape.endClippint.y) / 2;\n  }\n\n  get svgLinePath() {\n    return [\n      'M', this.from.concept.x + this.shape.startClipping.x, this.from.concept.y + this.shape.startClipping.y,\n      'L', this.to.concept.x + this.shape.endClippint.x, this.to.concept.y + this.shape.endClippint.y\n    ].join(' ');\n  }\n\n  ngOnInit() {\n    this.manager.addPropositionComponent(this);\n    this.from = this.manager.getConceptComponent(this.proposition.from);\n    this.to = this.manager.getConceptComponent(this.proposition.to);\n\n    // get focus on creation\n    if (!this.proposition.text) { // todo - a better way to detect is needed.\n      window.setTimeout(() => {\n        this.selection.clear();\n        this.selection.addPropositionComponent(this);\n        this.enableEdit();\n      }, 0);\n    }\n  }\n\n  ngDoCheck() {\n    // update line path if needed //\n    const vx = this.to.concept.x - this.from.concept.x;\n    const vy = this.to.concept.y - this.from.concept.y;\n    if (\n        this.shape.diff.x !== vx || this.shape.diff.y !== vy\n        ||\n        this.shape.from.width !== this.from.width || this.shape.from.height !== this.from.height\n        ||\n        this.shape.to.width !== this.to.width || this.shape.to.height !== this.to.height\n      ) {\n      this.shape.diff.x = vx;\n      this.shape.diff.y = vy;\n      this.shape.from.width = this.from.width;\n      this.shape.from.height = this.from.height;\n      this.shape.to.width = this.to.width;\n      this.shape.to.height = this.to.height;\n\n      const fromClipped = rectangleClip(this.from.width, this.from.height, -this.shape.diff.x, -this.shape.diff.y);\n      const toClipped = rectangleClip(this.to.width, this.to.height, this.shape.diff.x, this.shape.diff.y);\n\n      this.shape.startClipping.x = fromClipped.x;\n      this.shape.startClipping.y = fromClipped.y;\n      this.shape.endClippint.x = toClipped.x;\n      this.shape.endClippint.y = toClipped.y;\n    }\n  }\n\n  ngOnDestroy() {\n    this.manager.removePropositionComponent(this);\n  }\n\n  select() {\n    this.selected = true;\n  }\n\n  deselect(): void {\n    this.selected = false;\n    if (this.editable) {\n      this.disableEdit();\n    }\n  }\n\n  enableEdit() {\n    this.editable = true;\n    this.preventSelect = false;\n\n    window.setTimeout(() => {\n      this.label.nativeElement.focus();\n      const range = document.createRange();\n      range.selectNodeContents(this.label.nativeElement);\n      const sel = window.getSelection();\n      sel.removeAllRanges();\n      sel.addRange(range);\n    }, 0);\n  }\n\n  disableEdit() {\n    this.editable = false;\n    this.preventSelect = true;\n  }\n\n  doubleClick(event) {\n    event.stopPropagation();\n    // when not selecting\n    if (!event.ctrlKey && !event.shiftKey) {\n      if (!this.editable) {\n        this.enableEdit();\n      }\n    }\n  }\n\n  mouseDown(event) {\n    this.mouse.down(this, event);\n    if (event.which === 1) {\n      if (!this.editable /* disable drag while been editable */) {\n\n        if (event.ctrlKey || event.shiftKey) {\n          if (this.selected) {\n            let dragged = false;\n            this.mouse.drag(\n              e => dragged = true,\n              e => {\n                if (e.browserEvent.which === 1 && !dragged) {\n                  this.selection.removePropositionComponent(this);\n                }\n              }\n            );\n          } else {\n            this.selection.addPropositionComponent(this);\n          }\n        } else {\n          if (this.selected) {\n            let dragged = false;\n            this.mouse.drag(\n              e => dragged = true,\n              e => {\n                if (e.browserEvent.which === 1 && !dragged) {\n                  this.selection.clear();\n                  this.selection.addPropositionComponent(this);\n                }\n              }\n            );\n          } else {\n            this.selection.clear();\n            this.selection.addPropositionComponent(this);\n          }\n        }\n\n        this.mouse.drag(\n          e => {\n            this.mouse.cursorStyle = 'move';\n            this.selection.selectedConceptComponent.forEach((c) => {\n              if (c !== this.from && c !== this.to) {\n                c.concept.x += e.browserEvent.movementX;\n                c.concept.y += e.browserEvent.movementY;\n              }\n            });\n            for (const c of [this.from, this.to]) {\n              c.concept.x += e.browserEvent.movementX;\n              c.concept.y += e.browserEvent.movementY;\n            }\n\n          },\n          e => {\n            if (e.browserEvent.which === 1)  {\n              this.mouse.cursorStyle = 'default';\n            }\n          }\n        );\n\n      }\n    }\n    event.stopPropagation();\n  }\n\n  mouseUp(event) {\n    this.mouse.up(this, event);\n    event.stopPropagation();\n  }\n\n  keyDown(event) {\n    if (this.ctrlA.match(event) || (event.key === 'Delete' || event.key === 'Del' || event.which === 46)) {\n      event.stopPropagation();\n    }\n    setTimeout(() => {}, 0);  // used to manually trigger angular life cycle check to detect element size change.\n  }\n\n}\n","import { Injectable } from '@angular/core';\n\nimport { ConceptComponent } from './concept.component';\nimport { PropositionComponent } from './proposition.component';\n\n/**\n * Class implementing this interface will be managed by selection service and get notified on selecting and deselecting\n */\nexport interface Selectable {\n  select(): void;\n  deselect(): void;\n}\n\n/**\n * SelectionService is used to mark elements as selected.\n */\n@Injectable()\nexport class SelectionService {\n  selectedConceptComponent = new Set<ConceptComponent>();\n  selectedPropositionComponent = new Set<PropositionComponent>();\n\n  addConceptComponent(component: ConceptComponent) {\n    this.selectedConceptComponent.add(component);\n    component.select();\n  }\n\n  addPropositionComponent(component: PropositionComponent) {\n    this.selectedPropositionComponent.add(component);\n    component.select();\n  }\n\n  removeConceptComponent(component: ConceptComponent) {\n    if (this.selectedConceptComponent.delete(component)) {\n      component.deselect();\n    }\n  }\n\n  removePropositionComponent(component: PropositionComponent) {\n    if (this.selectedPropositionComponent.delete(component)) {\n      component.deselect();\n    }\n  }\n\n  clear() {\n    this.selectedConceptComponent.forEach(c => c.deselect());\n    this.selectedPropositionComponent.forEach(c => c.deselect());\n    this.selectedPropositionComponent.clear();\n    this.selectedConceptComponent.clear();\n  }\n\n}\n\n","\n/**\n * Modifier keys object\n */\nexport class ModifierKey {\n\n  static ctrl = new ModifierKey(event => event.ctrlKey);\n  static shift = new ModifierKey(event => event.shift);\n  static alt = new ModifierKey(event => event.altKey);\n  static meta = new ModifierKey(event => event.metaKey);\n\n  private predicate: (event: any) => boolean;\n\n  constructor(predicate: (event: any) => boolean) {\n    this.predicate = predicate;\n  }\n\n  match(keyboardEvent: any): boolean {\n    return this.predicate(keyboardEvent);\n  }\n\n  notMatch(keyboardEvent: any): boolean {\n    return !this.predicate(keyboardEvent);\n  }\n}\n\n/**\n * Object used to match keyboard events\n * Will match keyboard events that have exactly same set of modifier keys.\n */\nexport class KeyCombination {\n\n  static modifierKey = ModifierKey;\n\n  key: string;\n  modifiers: ModifierKey[];\n  excludes: ModifierKey[] = [ModifierKey.ctrl, ModifierKey.shift, ModifierKey.alt, ModifierKey.meta];\n\n  constructor(key: string, modifiers: ModifierKey[]) {\n    this.key = key.toUpperCase();\n    this.modifiers = modifiers;\n    this.excludes = this.excludes.filter(m => !modifiers.includes(m));\n  }\n\n  match(keyboardEvent): boolean {\n    return (keyboardEvent.key ? keyboardEvent.key.toUpperCase() === this.key : keyboardEvent.which === this.key.charCodeAt(0)) &&\n    this.modifiers.every(m => m.match(keyboardEvent)) && this.excludes.every(m => m.notMatch(keyboardEvent));\n  }\n}\n"],"sourceRoot":""}